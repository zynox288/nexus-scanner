    html += "<!DOCTYPE html>"
        "<html lang=\"en\">"
        "<head>"
        "<head>"
        "<meta charset=\"UTF-8\">"
        "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">"
        "<title>NEXUS | Dashboard</title>"
        "<link href=\"https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&display=swap\" rel=\"stylesheet\">"
        "<style>"
        ":root {"
        ":root {"
        "  --bg-dark: #0a0a0f; --bg-panel: #1a0505; --red-dim: #5c0b0b; --red-bright: #ff1f1f1f; --text-main: #ffffff; --text-muted: #a0a0a0a0a0a0a; --discord-blurple: #5865F2; }"
        "body { margin: 0; background-color: var(--bg-dark); color: var(--text-main); font-family: 'Segoe UI', sans-serif; overflow: hidden; height: 100vh; }"
        "body::before {"
        "  content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; "
        "  background: linear-gradient(circle at center, #2a0505 0%, #000000 100%); "
        "  background-size: 50px 50px; background-size: 100px 100px; "
        "  animation: moveStars 20s linear infinite; "
        "  animation: moveStars { 0% { transform: 0, 0; } 100% { transform: -100px; } 0% { transform: -100px; } "
        "}"
        "}"
        "@keyframes moveStars { "
        " 0% { transform: translate(0, 0); } 100% { transform: 0, -100px; } "
        "}"
        "</style>"
        "</head>"
        "<body>"
        "<div class=\"login-view\">"
        "<div class=\"login-box\">"
        "<div class=\"logo\">NEXUS</div>"
        "<p style=\"color: #888;\">Advanced Security System</p>"
        "<!-- UPDATED DISCORD LINK WITH YOUR SPECIFIC CLIENT ID -->
        "<a href=\"https://discord.com/oauth2/authorize?client_id=1467185981414792 &response_type=code&redirect_uri=https%3A%2F%2Fzynox288.github.io%2Fnexus-scanner%2F&scope=openid\" class=\"discord-link\">"
        "<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill="white\">"
        "<path d="M20.317 4.37a19.791 19.791 0 0 0 - 4.885 - 1.515.074.074 0 0 0 0 - .079.037c - .21.375 - .444.864 - .608 1.25a18.27 18.27 0 0 0 - 5.487 0 12.64 0 0 0 0 - 0.617 - 1.25.077 0 0 0 - .079 - .037A19.736 19.736 0 0 0 0 0.032.027C.533 9.046 - .32 13.58.099 18.057a.082.082 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    ":root { --bg-dark: #0a0a0f; --bg-panel: #1a0505; --red-dim: #5c0b0b; --red-bright: #ff1f1f1f; --text-main: #ffffff; --text-muted: #a0a0a0a; --discord-blurple: #5865F2; }"
        "body { margin: 0; background-color: var(--bg-dark); color: var(--text-main); font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        /* --- ANIMATION */
        "body::before {"
        "  content: ''; position: fixed; top: 0; left: 0; width: 0; height: 0; "
        "  background: linear-gradient(circle at center, #2a0505 0%, #000000 100%); "
        "  background-size: 50px 50px; background-size: 100px; "
        "  animation: moveStars 20s linear infinite; "
        "  animation: moveStars { 0% { transform: 0, 0; } 100% { transform: -0; } 0% { transform: -0; } "
        "}"

        /* --- UI HELPERS --- */
        "body::before {"
        "  content: ''; position: fixed; top: 0; left: 0; width: 0; height: 0; "
        "  background: radial-gradient(circle at center, #2a0505 0%, #000000 100%); "
        "  animation: moveStars { 0% { transform: 0, 0; } 100% { transform: -0; } 0 { 0; transform: -0; } "
        "}"

        ".login-box {"
        "  background: var(--bg-panel); padding: 40px; border-radius: 12px; text-align: center; box-shadow: 0 0 50px rgba(255, 0, 0, 0.2); border: 1px solid var(--red-dim); width: 350px; "
        "  font-size: 3rem; font-weight: 0; color: var(--red-bright); margin-bottom: 10px; letter-spacing: 2px; text-shadow: 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; }

        ".logo {"
        "  font-size: 3rem; font-weight: 0; color: var(--red-bright); margin-bottom: 10px; letter-spacing: 2px; text-shadow: 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; "
        ".discord-link {"
        "  background-color: var(--discord-blurple); color: white; border: none; padding: 12px 24px; border-radius: 5px; font-size: 16px; font-weight: 600; cursor: pointer; "
        "  width: 100%; margin-top: 30px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.2s; text-decoration: none; "
        "  hover { background-color: #4752c4c; "
        "  transform: translateY(-4px); }"
        "
        /* --- DASHBOARD STYLE --- */
        "#dashboard-view {"
        "    display: none; padding: 20px; max-width: 1000px; margin: 0; position: relative; overflow-y: auto; "
        "    /* Hide by default, handled in wWinMain by the C++ code */
        "    position: relative; z-index: 1; "
        "    background: radial-gradient(circle at center, #2a0505 0%, #000000 100%); "
        /* ...Dashboard Styles */
        "nav { "
        "    display: flex; justify-content: space-between; align-items: center; "
        "    padding: 20px 0; border-bottom: 1px solid var(--red-dim); margin-bottom: 30px; "
        "    display: flex; align-items: center; "
        "    <div class=\"logo\" style=\"font-size: 1.5rem; margin-bottom: 0; margin-right: 0; color: var(--red-bright); margin-top: 0; margin: 0; color: #888;" > "
        "    <div style=\"display: flex; align-items: center; "
        "    <span class=\"status-indicator\" id=\"status-dot\"></span>"
        "    <span id=\"status-text\" style=\"font-size: 0.9rem; color: #888;" > Checking Connection... < / span> "
        "</div>"

        "<div class=\"dashboard-grid" > "
        "    <!-- PIN Generator Card "
        "    <div class=\"card\">"
        "    <h3>üîê Security PIN (Limit: 5)</h3> "
        "    <div class=\"pin-display\" id=\"pin-display\">...</div> "
        "    <button class=\"btn-primary\" id=\"genBtn\" onclick=\"generatePIN()\">Generate New PIN</button> "
        "    <p style=\"font-size: 0.8rem; color: #666; margin-top: 10px; text-align: center;\" id=\"limit-text\">Generations remaining: 5</p> "
        "    </div> "
        " <!-- Scanner Status Card "
        "    <div class=\"card\"> "
        "    <h3>üõ°Ô∏è Scanner Status</h3> "
        "    <p style=\"color: #aaa; margin-bottom: 5px; "
        "    <div id=\"scan-status\" "
        "        IDLE"
        "    </div> "
        "</div> "
        "</div> "

        "<!-- Results Card "
        "<div class=\"card\"> "
        "    <h3>üìä Live Scan Results</h3> "
        "<div class=\"results-container\" id=\"results-container\" id=\"results-container\"> "
        "<div class=\"empty-state\">"
        "    <p style=\"text-align: center; padding: 40px; color: #666;"
        "    <p style=\"font-size: 0.85rem; margin-top: 10px; color: #888;"
        "        Start a scan to see results here"
        "</div> "
        "</div> "
        "</div> "
        "</div>"

        "<div class=\"instructions\"> "
        "<h4>üìã How to Use:</h4> "
        "<ol>"
        "<li>Run <strong>NEXUS Scanner</strong></li> "
        "<li>Click <strong>Generate</strong> a new PIN in the dashboard</li> "
        "<li>Enter the PIN into the scanner app</li> "
        "<li>Unlock and Scan C: Drive</li> "
        "<li>View results here in real-time!</li> "
        "</ol>"

        "<script> "
        "const API_URL = 'http://127.0.0.0.1:3000/api'; " // Localhost (Scanner API)
        "let connectionCheckInterval;"

        // 1. Handle Discord Redirect
        "window.onload = function() {"
        "  const urlParams = new URLSearchParams(window.location.search); "
        const code = urlParams.get('code'); "
        "  if (code) {"
        "    document.getElementById('login-view').style.display = 'none'; "
        "    document.getElementById('dashboard-view').style.display = 'block'; "
        "    checkConnection(); "
}
 else {
    "
        "    document.getElementById('login-view').style.display = 'block'; "
        "    checkConnection(); "
        "  }"
        "}"

        "function login() {"
        "  const btn = document.querySelector('.discord-link'); "
        "  btn.innerHTML = 'Redirecting to Discord...';"
        "}"

        "function checkConnection() {"
        "  fetch(`${API_URL}/status`)"
        "    .then(res => res.json())"
        "    .then(data => {"
        "      document.getElementById('status-dot').classList.add('online'); "
        "      document.getElementById('status-text').innerText = 'Connected to Scanner'; "
        "      document.getElementById('connection-warning').style.display = 'none'; "
        "      document.getElementById('scan-status').innerText = data.scanning ? 'SCANNING...' : 'IDLE'; "
        "      loadPIN(); "
        "      loadResults(); "
        "    })"
        "    .catch(() => { "
        "    document.getElementById('status-dot').classList.remove('online'); "
        "    document.getElementById('status-text').innerText = 'Disconnected'; "
        "    document.getElementById('connection-warning').style.display = 'block'; "
        "    })"
        "    .catch(() => {}); "
        "}"

        "function generatePIN() { "
        "  fetch(`${API_URL}/generate-pin`, { method: 'POST' }) "
        "    .then(res => {"
        "      if (!res.ok) { "
        "        if (res.status === 403) { "
        "            alert('‚ö†Ô∏è Limit Reached!\n\nYou cannot generate more PINs.\nRestart the scanner to reset.'
        "            document.getElementById('genBtn').disabled = true; "
        "            document.getElementById('genBtn').innerText = 'LIMIT REACHED'; "
        "            throw new Error('Limit reached'); "
        "      }"
        "      return res.json(); "
        .then(data = > { "
            "      updatePINDisplay(data.pin); "
            "      updateLimitText(data.remaining); "
            "      updateLimitText(data.remaining); "
            "      updatePINDisplay(data.pin); "
            // Immediate update logic ensures that the visual display changes instantly.
            "      updateLimitText(data.remaining); "
            .catch (err = > console.error('PIN generation error:', err)); "
            "}"

            "function updatePINDisplay(newPin) { "
            "  const pinDisplay = document.getElementById('pin-display'); "
            "  pinDisplay.innerText = newPin; // Immediate update
            "  pinDisplay.style.animation = 'none'; "
            "  setTimeout(() => { "
            "  pinDisplay.style.animation = 'slideIn 0.3s ease'; "
            "; "
    } "
            "        "
            "        pinDisplay.innerText = newPin; "
            "        setTimeout(() => { "
            "          pinDisplay.style.animation = 'slideIn 0.3s ease; "
            "        setTimeout(() => { "
            "  pinDisplay.style.animation = 'slideIn 0.3s ease'; "
            "        setTimeout(() => { "
            "    pinDisplay.style.animation = 'slideIn 0.3s ease; "
            "    }, "
            "    setTimeout(() => { "
            "        pinDisplay.style.animation = 'slideIn 0.3s ease; "
            "    }, "
            "    }, 
            "    "
            "    setTimeout(() => { "
            "        pinDisplay.style.animation = 'slideIn 0.3s ease; "
            "    }, "
            "    updateLimitText(data.remaining); "
            "    if (remaining === 0) { "
            "    document.getElementById('genBtn').disabled = true; "
            "    document.getElementById('genBtn').innerText = 'LIMIT REACHED'; "
            "    }"
            "}"
            "        }

            "function loadPIN() { "
            "  fetch(`${API_URL}/pin`) "
            "    .then(r => r.json()) "
            "    .then(data => {"
            "        // Only update display if it's currently "..." (empty) (empty state)
            "        if (currentDisplay === '...' && data.pin != "") { "
            "        updatePINDisplay(data.pin); "
            "        if (data.remaining !== undefined) { "
            "    updateLimitText(data.remaining); "
            "    if (data.remaining === 0) { "
            "        document.getElementById('genBtn').disabled = true; "
            "        document.getElementById('genBtn').innerText = 'LIMIT REACHED'; "
            "    } "
            "    } "
            "    .catch(() => {}); "
            "}"

            "function loadResults() { "
            "  fetch(`${API_URL}/results`) "
            "    .then(r => r.json()) "
            "    .then(data => { "
            "      const container = document.getElementById('results-container'); "
            "      if (data.length === 0) { "
            "        container.innerHTML = ``
            ` < div class = "empty-state"> "
            "            <p>‚úÖ No threats detected</p> "
            "            <p style=\"font-size: 0.85rem; margin-top: 10px; color: #666;"
            "            Your system is clean! "
            "        "
            `;`
            "        return; "
            "        container.innerHTML = ''; "
            "        data.forEach((item, index) { "
            "        const div = document.createElement('div'); "
            "        div.className = 'result-item'; "
            "        div.style.animationDelay = `${index * 0.1}s;`
            "        div.innerHTML = ``
            "          <div class=\"threat-name\">${item.threat}</div> "
            "          <div style=\"color:#aaa; font-family:monospace; font-size:0.85rem; margin-top: 5px;"
            "          <div style=\"color:#aaa; font-family:monospace; font-size:0.85rem; margin-top:5px; color:#aaa; font-size:0.8rem;"
            "          ${item.path} "
            "        </div> "
            "        container.appendChild(div); "
            "    }) "
            "    .catch(() => {}); "
            "    .catch(() => {}); "
            "}");

    // Auto-refresh results when scanning
    "    setInterval(() => { "
        "  const scanStatus = document.getElementById('scan-status').innerText; "
        "  if (scanStatus === 'SCANNING...') { "
        "      loadResults(); "
        "  }"
        "    .catch () => {}); "
        ")"
        "</script> "
        "</body>"
        "</html>"
